# Parent Issue Summary – Chapter 6 Day 1 Frontend Integration

Use this blurb under the parent GitHub issue when referencing `specs/003-frontend-integration/tasks.md`. Tasks marked `[P]` can run in parallel after Foundational work; Phase 3 (US1) remains the MVP milestone before layering US2 and US3.

## Copy-ready checklist (same format as `tasks.md`)

- [ ] T001 Configure API + telemetry environment variables in `/Users/prnceb/Desktop/WORK/training-prince/frontend/.env` by copying `frontend/.env.example` and setting `NEXT_PUBLIC_API_BASE_URL` plus `NEXT_PUBLIC_TELEMETRY_REFRESH_ENDPOINT`.
- [ ] T002 [P] Add `@tanstack/react-query`, `@tanstack/react-query-devtools`, `react-window`, `date-fns`, and `classnames` dependencies plus workspace scripts inside `/Users/prnceb/Desktop/WORK/training-prince/frontend/package.json` (run install to refresh lockfile).
- [ ] T003 Update `/Users/prnceb/Desktop/WORK/training-prince/package.json` scripts and `/Users/prnceb/Desktop/WORK/training-prince/frontend/README.md` so `npm run dev:frontend`, `npm run test:frontend`, and `npm run lint:frontend` follow the Quickstart instructions (Fast 3G throttle + screenshot capture prep).
- [ ] T004 Create the Next.js App Router shell for `/expenses` in `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/layout.tsx`, injecting the TanStack Query + filter providers and base grid structure defined in `plan.md`.
- [ ] T005 [P] Implement `QueryProvider` with a preconfigured `QueryClient`, devtools toggle, and default stale/refetch timings in `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/providers/QueryProvider.tsx`.
- [ ] T006 [P] Build the shared filter controller + hook (`ExpenseFiltersProvider` and `useExpenseFilters`) under `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/context/ExpenseFiltersProvider.tsx` and `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/hooks/useExpenseFilters.ts`, syncing URL search params and emitting telemetry metadata.
- [ ] T007 [P] Define the client-side data mappers for `Expense`, `PaginatedExpenseResponse`, `ExpenseSummary`, and `UIStateEvidence` at `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/models/expense.ts`, `paginatedResponse.ts`, and `summary.ts` to match `data-model.md` (including formatting helpers + validation guards).
- [ ] T008 Implement telemetry + stale timer utilities in `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/utils/trackRefresh.ts` and `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/utils/staleTimers.ts` so manual/auto refreshes emit `frontend.expenses.refresh_ms` and stale banners fire after five minutes.
- [ ] T009 [P] [US1] Author Vitest contract coverage for GET `/expenses` loading/empty/error/success permutations in `/Users/prnceb/Desktop/WORK/training-prince/tests/contract/expenses-list.contract.test.ts` using the OpenAPI fixtures.
- [ ] T010 [P] [US1] Create a Playwright journey `/Users/prnceb/Desktop/WORK/training-prince/tests/e2e/expenses-list.spec.ts` that throttles to Fast 3G, asserts skeleton appearance within 200 ms, and exercises retry/pagination paths.
- [ ] T011 [P] [US1] Implement the accessible filter toolbar with category + month inputs, URL sync, and shared CTA wiring inside `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/components/ExpenseFiltersBar.tsx`.
- [ ] T012 [P] [US1] Build the virtualized list UI (20 skeleton rows, alternating colors, pagination footer) with `react-window` inside `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/components/ExpensesList.tsx`.
- [ ] T013 [US1] Create the TanStack Query hook for GET `/expenses` with cache keys tied to filters, error handling, and stale banner metadata in `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/hooks/useExpensesQuery.ts`.
- [ ] T014 [US1] Compose `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/page.tsx` so the list, filters, stale banner, and manual refresh icon share telemetry + focus restoration per FR-004/FR-010.
- [ ] T015 [US1] Capture and store `state-loading.png`, `state-empty.png`, `state-error.png`, and `state-success.png` artifacts under `/Users/prnceb/Desktop/WORK/training-prince/specs/003-frontend-integration/` with captions referencing FR-005.
- [ ] T016 [P] [US2] Write Vitest validation-matrix tests covering positive flow + five error permutations in `/Users/prnceb/Desktop/WORK/training-prince/tests/contract/add-expense-drawer.contract.test.ts`.
- [ ] T017 [P] [US2] Extend Playwright coverage in `/Users/prnceb/Desktop/WORK/training-prince/tests/e2e/add-expense-drawer.spec.ts` to verify drawer focus trap, duplicate submit prevention, and toast behavior.
- [ ] T018 [P] [US2] Build `<AddExpenseDrawer />` with focus trap, aria labels, and helper text inside `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/components/AddExpenseDrawer.tsx` following the contract table.
- [ ] T019 [P] [US2] Implement `useCreateExpenseMutation` in `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/hooks/useCreateExpenseMutation.ts` to post payloads, disable the submit button, and optimistically insert new rows.
- [ ] T020 [US2] Wire drawer triggers (header CTA, empty state CTA, summary CTA) plus focus restoration within `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/page.tsx`.
- [ ] T021 [US2] Emit telemetry + validation logs for successes/errors via `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/utils/trackRefresh.ts` and ensure stale banners clear after POST success.
- [ ] T022 [US2] Document the validation matrix + screenshot references for the drawer in `/Users/prnceb/Desktop/WORK/training-prince/specs/003-frontend-integration/contracts/add-expense-drawer.contract.md` so QA evidence stays synced.
- [ ] T023 [P] [US3] Implement Vitest contract assertions for summary totals + filter chips in `/Users/prnceb/Desktop/WORK/training-prince/tests/contract/expenses-summary.contract.test.ts`.
- [ ] T024 [P] [US3] Add Playwright e2e coverage at `/Users/prnceb/Desktop/WORK/training-prince/tests/e2e/expenses-summary.spec.ts` for load/empty/error flows plus retry-only summary behavior.
- [ ] T025 [P] [US3] Build `useExpenseSummaryQuery` with shared cache keys and generatedAt timestamps under `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/hooks/useExpenseSummaryQuery.ts`.
- [ ] T026 [P] [US3] Create `<ExpenseSummaryPanel />` with three tiles, loading shimmers, and retry-only refresh logic inside `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/components/ExpenseSummaryPanel.tsx`.
- [ ] T027 [US3] Implement filter chip rendering + clear buttons plus aria-live messaging in `/Users/prnceb/Desktop/WORK/training-prince/frontend/app/expenses/components/FilterChips.tsx`, ensuring chips update both list and summary.
- [ ] T028 [US3] Capture summary-state screenshots (loading/empty/error/success) and store them beside captions in `/Users/prnceb/Desktop/WORK/training-prince/specs/003-frontend-integration/` to satisfy FR-005.
- [ ] T029 [P] Add automated Axe + `@axe-core/playwright` accessibility regression suite at `/Users/prnceb/Desktop/WORK/training-prince/tests/e2e/expenses-accessibility.spec.ts` and resolve any WCAG AA violations.
- [ ] T030 [P] Update `/Users/prnceb/Desktop/WORK/training-prince/ACCESSIBILITY_AUDIT.md` and `/Users/prnceb/Desktop/WORK/training-prince/CHANGELOG.md` with the new UI states, telemetry metric, and screenshot references.
- [ ] T031 Run the Quickstart validation (`npm run dev:frontend`, `npm run test`, `npm run lint`, `npm run test:e2e`) and record outcomes plus troubleshooting tips inside `/Users/prnceb/Desktop/WORK/training-prince/specs/003-frontend-integration/quickstart.md`.
